<!-- words/templates/words/word_list.html -->
{% extends "words/base.html" %}

{% block title %}–ú–æ–∏ —Å–ª–æ–≤–∞{% endblock %}

{% block content %}
<h1 class="mb-4">–ú–æ–∏ —Å–ª–æ–≤–∞</h1>

{% if words %}
  <ul class="list-group">
    {% for word in words %}
      <li class="list-group-item d-flex justify-content-between align-items-center">
        <div>
          <strong>{{ word.text }}</strong> ‚Äî {{ word.translation }}<br>
          <small class="text-muted">–°–ª–µ–¥—É—é—â–µ–µ –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–µ: {{ word.next_review|date:"d.m.Y H:i" }}</small>
        </div>
        <div>
          <a href="{% url 'word-detail' word.pk %}" class="btn btn-sm btn-info">–ü—Ä–æ—Å–º–æ—Ç—Ä</a>



          <!-- –ö–Ω–æ–ø–∫–∏ –æ–∑–≤—É—á–∫–∏ -->
          <button class="btn btn-sm btn-success" onclick="playAudio({{ word.id }}, 'word')" title="–û–∑–≤—É—á–∏—Ç—å —Å–ª–æ–≤–æ">üîä</button>
          <button class="btn btn-sm btn-secondary" onclick="playAudio({{ word.id }}, 'translation')" title="–û–∑–≤—É—á–∏—Ç—å –ø–µ—Ä–µ–≤–æ–¥">üîä</button>
        </div>
      </li>
    {% endfor %}
  </ul>
{% else %}
  <p class="text-muted">–£ —Ç–µ–±—è –ø–æ–∫–∞ –Ω–µ—Ç —Å–ª–æ–≤. –î–æ–±–∞–≤—å –∏—Ö üëá</p>
{% endif %}

<a href="{% url 'word-create' %}" class="btn btn-primary mt-3">–î–æ–±–∞–≤–∏—Ç—å —Å–ª–æ–≤–æ</a>

<!-- –°–∫—Ä–∏–ø—Ç –¥–ª—è –æ–∑–≤—É—á–∫–∏ -->
<script>
function playAudio(wordId, type) {
    let url;
    if (type === 'word') {
        url = `{% url 'word-audio' pk=0 %}`.replace('0', wordId);
    } else {
        url = `{% url 'word-translation-audio' pk=0 %}`.replace('0', wordId);
    }
    const audio = new Audio(url);
    audio.play().catch(e => {
        console.error("–û—à–∏–±–∫–∞ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è:", e);
        alert("–ù–µ —É–¥–∞–ª–æ—Å—å –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ—Å—Ç–∏ –∞—É–¥–∏–æ.");
    });
}
</script>

{% endblock %}